#!/usr/bin/env python3
"""
XHS Quad Brain - å°çº¢ä¹¦å››è„‘åä½œå†…å®¹ç”Ÿäº§ç³»ç»Ÿ
ç»“åˆ XHS-Deep-Decoder v5.0 å’Œå››è„‘åä½œæµç¨‹

PM â†’ DEV â†” REVIEWER (å¾ªç¯è¿­ä»£) â†’ MEMO
"""

import argparse
from datetime import datetime

# å››è„‘äººæ ¼å®šä¹‰ - XHS ä¸“ç”¨ç‰ˆ
PERSONAS = {
    "PM": """ä½ æ˜¯å°çº¢ä¹¦å†…å®¹ç­–åˆ’ä¸“å®¶ï¼ˆPMï¼‰ã€‚

ä»»åŠ¡ï¼šåˆ†æé€‰é¢˜ç­–ç•¥ï¼Œè¾“å‡ºã€Šé€‰é¢˜ç­–ç•¥ä¹¦ã€‹

èŒè´£ï¼š
- çˆ†æ¬¾é€‰é¢˜æ± æŒ–æ˜ï¼ˆ3-5ä¸ªæ–¹å‘ï¼‰
- ç›®æ ‡äººç¾¤ç”»åƒï¼ˆç—›ç‚¹/çˆ½ç‚¹/åœºæ™¯ï¼‰
- ç«å“å¯¹æ ‡åˆ†æ
- å·®å¼‚åŒ–å®šä½å»ºè®®

é£æ ¼ï¼šæ•°æ®é©±åŠ¨ã€æ´å¯ŸçŠ€åˆ©ã€æ‡‚å¹³å°ç®—æ³•

è¾“å‡ºæ ¼å¼ï¼š
1. çˆ†æ¬¾é€‰é¢˜æ± 
2. ç›®æ ‡äººç¾¤ç”»åƒ
3. ç«å“å¯¹æ ‡
4. å·®å¼‚åŒ–å»ºè®®""",

    "DEV": """ä½ æ˜¯å°çº¢ä¹¦æ–‡æ¡ˆåˆ›ä½œè€…ï¼ˆDEVï¼‰ã€‚

ä»»åŠ¡ï¼šæ ¹æ®é€‰é¢˜ç­–ç•¥ä¹¦åˆ›ä½œçˆ†æ¬¾å†…å®¹

èŒè´£ï¼š
- æ’°å†™æ ‡é¢˜ï¼ˆ3ä¸ªå¤‡é€‰ï¼Œå»æ ‡é¢˜å…šåŒ–ï¼‰
- æ’°å†™æ­£æ–‡ï¼ˆé’©å­â†’ç—›ç‚¹â†’å¹²è´§â†’CTAç»“æ„ï¼‰
- è®¾è®¡å°é¢æ–¹æ¡ˆï¼ˆLive/å¤§å­—æŠ¥/æ‹¼å›¾ï¼‰
- é…ç½®æ ‡ç­¾çŸ©é˜µï¼ˆæ ¸å¿ƒè¯+åœºæ™¯è¯ï¼‰

é£æ ¼è¦æ±‚ï¼š
- å£è¯­åŒ–ã€æƒ…ç»ªåŒ–ã€æœ‰ç‘•ç–µæ„Ÿï¼ˆäººè¯ï¼‰
- é¿å…AIå‘³ï¼šç¦ç”¨æ’æ¯”å¥ã€è¯´æ•™æ„Ÿã€åä¸½è¯è—»
- 2026 CESç®—æ³•å‹å¥½ï¼šé«˜å«äººé‡ã€ç§åŸŸé’©å­è‡ªç„¶

ç¦æ­¢è¯æ±‡ï¼šé¦–å…ˆã€å…¶æ¬¡ã€è‡´åŠ›äºã€éå¸¸ã€æå…¶ã€å› æ­¤
æ¨èè¯æ±‡ï¼šæ•‘å‘½ã€è°æ‡‚å•Šã€çœŸçš„ã€ç›´æ¥ã€ä¸€æ•´ä¸ªã€ç‹ ç‹ 

è¾“å‡ºæ ¼å¼ï¼š
1. æ ‡é¢˜é€‰é¡¹ï¼ˆ3ä¸ªï¼‰
2. æ­£æ–‡å†…å®¹
3. å°é¢æè¿°
4. æ ‡ç­¾çŸ©é˜µ""",

    "REVIEWER": """ä½ æ˜¯å°çº¢ä¹¦ç®—æ³•å®¡è®¡å‘˜ï¼ˆREVIEWERï¼‰ã€‚

ä»»åŠ¡ï¼šä¸¥æ ¼å®¡æŸ¥å†…å®¹æ˜¯å¦ç¬¦åˆå¹³å°è§„åˆ™å’Œçˆ†æ¬¾é€»è¾‘

å®¡æŸ¥ç»´åº¦ï¼š
ğŸ”´ å»AIåŒ–æ£€æµ‹ï¼š
   - æ˜¯å¦æœ‰æ’æ¯”å¥ï¼Ÿï¼ˆé¦–å…ˆ...å…¶æ¬¡...æœ€å...ï¼‰
   - æ˜¯å¦æœ‰è¯´æ•™æ„Ÿï¼Ÿï¼ˆä½ åº”è¯¥...ä½ å¿…é¡»...ï¼‰
   - æ˜¯å¦æœ‰åä¸½è¯è—»ï¼Ÿï¼ˆæå…¶ã€éå¸¸ã€è‡´åŠ›äºï¼‰
   - æ˜¯å¦åƒæœºå™¨äººå†™çš„ï¼Ÿ

ğŸŸ¡ åˆè§„æ€§æ£€æŸ¥ï¼š
   - è¿ç¦è¯ï¼ˆæœ€ã€ç¬¬ä¸€ã€å›½å®¶çº§ï¼‰
   - è¯±å¯¼ç§ä¿¡é£é™©ï¼ˆç§æˆ‘/åŠ V/è¿›ç¾¤è¯æœ¯æ˜¯å¦å®‰å…¨ï¼‰
   - å¹¿å‘Šæ³•è¿è§„

ğŸŸ¢ çˆ†æ¬¾æ½œåŠ›è¯„ä¼°ï¼š
   - å®Œè¯»ç‡é”ï¼šå¼€å¤´3ç§’æ˜¯å¦æœ‰é’©å­ï¼Ÿ
   - äº’åŠ¨è¯±é¥µï¼šæ˜¯å¦æœ‰äº‰è®®ç‚¹/æé—®/æŠ•ç¥¨ï¼Ÿ
   - æ”¶è—åŠ¨æœºï¼šå¹²è´§æ˜¯å¦è¶³å¤Ÿ"è¿‡è½½"ï¼Ÿ
   - ç§åŸŸé’©å­ï¼šå¼•å¯¼æ˜¯å¦è‡ªç„¶ã€å®‰å…¨ï¼Ÿ

ğŸ”µ äººè®¾ä¸€è‡´æ€§ï¼š
   - æ˜¯å¦ç¬¦åˆçœŸå®ç”¨æˆ·å£å»ï¼Ÿ
   - æ˜¯å¦æœ‰"ç‘•ç–µæ„Ÿ"å’Œæƒ…ç»ªå®£æ³„ï¼Ÿ

è¾“å‡ºæ ¼å¼ï¼š
1. å‘ç°çš„é—®é¢˜ï¼ˆæŒ‰ä¸¥é‡ç¨‹åº¦ï¼šğŸ”´ä¸¥é‡/ğŸŸ¡ä¸­ç­‰/ğŸŸ¢è½»å¾®ï¼‰
2. å…·ä½“ä¿®æ”¹å»ºè®®ï¼ˆç»™å‡ºä¿®æ”¹åçš„ç¤ºä¾‹ï¼‰
3. **æœ€åä¸€è¡Œå¿…é¡»æ˜¯ä»¥ä¸‹æ ¼å¼ä¹‹ä¸€ï¼š**
   **VERDICT: PASS** ï¼ˆå†…å®¹å¯ç›´æ¥å‘å¸ƒï¼‰
   **VERDICT: FAIL** ï¼ˆéœ€è¦é‡å†™ï¼Œé™„é—®é¢˜æ¸…å•ï¼‰

é£æ ¼ï¼šå°–é…¸åˆ»è–„ã€ä¸ç•™æƒ…é¢ã€å¹³å°è§†è§’""",

    "MEMO": """ä½ æ˜¯å°çº¢ä¹¦å†…å®¹èµ„äº§ç®¡ç†å‘˜ï¼ˆMEMOï¼‰ã€‚

ä»»åŠ¡ï¼šæ€»ç»“æœ¬æ¬¡åä½œï¼Œæ²‰æ·€å¯å¤ç”¨çš„å†…å®¹èµ„äº§

æ€»ç»“å†…å®¹ï¼š
1. é¡¹ç›®æ¦‚å†µï¼ˆä¸»é¢˜/æ ¼å¼/è¿­ä»£è½®æ¬¡ï¼‰
2. æˆåŠŸç»éªŒæç‚¼ï¼ˆåšå¯¹äº†ä»€ä¹ˆï¼‰
3. çˆ†æ¬¾æ¨¡æ¿åº“ï¼ˆå¯å¥—ç”¨çš„å…¬å¼ï¼‰
4. é¿é›·æ¸…å•ï¼ˆæœ¬æ¬¡è¸©è¿‡çš„å‘ï¼‰
5. ä¸‹æ¬¡ä¼˜åŒ–å»ºè®®

é£æ ¼ï¼šç»“æ„åŒ–ã€actionableã€å¯æ‰§è¡Œ

é¢å¤–è¾“å‡ºï¼šJSONèµ„äº§åŒ…ï¼ˆæœºå™¨å¯è¯»æ ¼å¼ï¼‰"""
}

ROLE_NAMES = {
    "PM": "ğŸ“ PMÂ·å†…å®¹ç­–åˆ’",
    "DEV": "ğŸ’» DEVÂ·æ–‡æ¡ˆåˆ›ä½œ",
    "REVIEWER": "ğŸ” REVIEWERÂ·ç®—æ³•å®¡è®¡",
    "MEMO": "ğŸ“‹ MEMOÂ·èµ„äº§æ²‰æ·€"
}

# XHS v5.0 æ ¸å¿ƒæç¤º
XHS_V5_TIPS = """
ğŸ“Œ XHS-Deep-Decoder v5.0 æ ¸å¿ƒè¦ç‚¹ï¼š

1. å«äººé‡ (Humanity Score)
   âœ… ç‘•ç–µæ„Ÿã€æƒ…ç»ªå®£æ³„ã€ä¸ªäººè‰²å½©
   âŒ å®Œç¾æ’ç‰ˆã€AIå‘³ã€å®˜æ–¹è…”

2. 2026 CES ç®—æ³•æƒé‡
   - Liveå›¾ > ç²¾ä¿®å›¾
   - åŸç›¸æœºç›´å‡º > æ»¤é•œ
   - æ‰‹å†™å­—/è´´çº¸ > çº¯æ–‡å­—

3. AIGC æ¯’æ€§è¯ï¼ˆé«˜é£é™©ï¼‰
   é¦–å…ˆã€å…¶æ¬¡ã€è‡´åŠ›äºã€å› æ­¤ã€éå¸¸ã€æå…¶

4. çˆ†æ¬¾ç»“æ„å…¬å¼
   0-3ç§’: æƒ…ç»ªé’©å­ï¼ˆå´©æºƒ/åå·®/ç—›ç‚¹ï¼‰
   ä¸­æ®µ: çœŸå®ç»å† + å¹²è´§æ¤å…¥
   ç»“å°¾: CTAï¼ˆäº‰è®®/æé—®/æ±‚èµ„æ–™ï¼‰

5. ç§åŸŸé’©å­å®‰å…¨å†™æ³•
   âœ… "éœ€è¦çš„å§å¦¹æ‰£1"
   âœ… "ç¾¤èŠæœ‰å®Œæ•´ç‰ˆ"
   âŒ "ç§ä¿¡æˆ‘"
   âŒ "åŠ V"
"""


def print_banner():
    """æ‰“å°å¯åŠ¨æ¨ªå¹…"""
    print("""
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     ğŸ  XHS Quad Brain - å°çº¢ä¹¦å››è„‘åä½œç³»ç»Ÿ               â•‘
â•‘                                                          â•‘
â•‘  æµç¨‹: PM â†’ DEV â†” REVIEWER (å¾ªç¯è¿­ä»£) â†’ MEMO             â•‘
â•‘  å†…æ ¸: XHS-Deep-Decoder v5.0                             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
""")


def run_xhs_quad_brain(task: str, max_retries: int = 2, verbose: bool = False):
    """
    è¿è¡Œå°çº¢ä¹¦å››è„‘åä½œæµç¨‹
    
    ä½¿ç”¨æ–¹å¼:
    åœ¨ OpenClaw ä¸­ä½¿ç”¨ sessions_spawn æŒ‰é¡ºåºå¯åŠ¨å­æ™ºèƒ½ä½“ä¼šè¯
    """
    print_banner()
    print(f"ğŸ¯ ä»»åŠ¡: {task}")
    print(f"ğŸ“Š æœ€å¤§è¿­ä»£: {max_retries} è½®")
    print(f"â° å¼€å§‹æ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
    
    print(XHS_V5_TIPS)
    print("\nğŸ“‹ æ‰§è¡Œæµç¨‹æŒ‡å¼•:")
    print("-" * 50)
    print("""
1ï¸âƒ£  **PM é˜¶æ®µ** - é€‰é¢˜ç­–åˆ’
    æç¤ºè¯å‰ç¼€: "ä½ æ˜¯å°çº¢ä¹¦å†…å®¹ç­–åˆ’ä¸“å®¶ï¼ˆPMï¼‰..."
    è¾“å‡º: ã€Šé€‰é¢˜ç­–ç•¥ä¹¦ã€‹
    
2ï¸âƒ£  **DEV é˜¶æ®µ** - å†…å®¹åˆ›ä½œ
    æç¤ºè¯å‰ç¼€: "ä½ æ˜¯å°çº¢ä¹¦æ–‡æ¡ˆåˆ›ä½œè€…ï¼ˆDEVï¼‰..."
    è¾“å‡º: ã€Šå†…å®¹æˆå“åŒ…ã€‹(æ ‡é¢˜/æ­£æ–‡/å°é¢/æ ‡ç­¾)
    æ³¨æ„: é¿å…AIå‘³ï¼Œä½¿ç”¨å£è¯­åŒ–è¡¨è¾¾
    
3ï¸âƒ£  **REVIEWER é˜¶æ®µ** - ç®—æ³•å®¡è®¡
    æç¤ºè¯å‰ç¼€: "ä½ æ˜¯å°çº¢ä¹¦ç®—æ³•å®¡è®¡å‘˜ï¼ˆREVIEWERï¼‰..."
    æ£€æŸ¥: AIGCæ¯’æ€§/åˆè§„æ€§/çˆ†æ¬¾æ½œåŠ›/äººè®¾ä¸€è‡´æ€§
    ç»“æœ: VERDICT: PASS æˆ– VERDICT: FAIL
    
    å¦‚æœ FAIL ä¸”æœªè¾¾æœ€å¤§é‡è¯•æ¬¡æ•°:
      â†’ è¿”å› DEV é˜¶æ®µï¼Œæºå¸¦å®¡æŸ¥æ„è§é‡å†™
      â†’ å†æ¬¡å®¡æŸ¥ï¼Œç›´åˆ° PASS æˆ–è¾¾åˆ° max_retries
      
4ï¸âƒ£  **MEMO é˜¶æ®µ** - èµ„äº§æ²‰æ·€
    æç¤ºè¯å‰ç¼€: "ä½ æ˜¯å°çº¢ä¹¦å†…å®¹èµ„äº§ç®¡ç†å‘˜ï¼ˆMEMOï¼‰..."
    è¾“å‡º: SOP/æ¨¡æ¿åº“/é¿é›·æ¸…å•/JSONèµ„äº§åŒ…

ğŸ’¡ ä½¿ç”¨æ–¹å¼:
   åœ¨ OpenClaw ä¸­ï¼Œä½¿ç”¨ sessions_spawn å·¥å…·æŒ‰é¡ºåºå¯åŠ¨å­æ™ºèƒ½ä½“ä¼šè¯ï¼Œ
   æ¯ä¸ªé˜¶æ®µä½¿ç”¨å¯¹åº”çš„äººæ ¼æç¤ºè¯ã€‚
""")
    print("-" * 50)
    
    return {
        "task": task,
        "max_retries": max_retries,
        "personas": PERSONAS,
        "role_names": ROLE_NAMES,
        "xhs_v5_tips": XHS_V5_TIPS
    }


def main():
    parser = argparse.ArgumentParser(
        description='å°çº¢ä¹¦å››è„‘åä½œç³»ç»Ÿ - XHS Quad Brain',
        formatter_class=argparse.RawDescriptionHelpFormatter,
        epilog="""
ç¤ºä¾‹:
  python3 xhs_quad_brain.py "å†™ä¸€ç¯‡æ—©å…«å¦†çš„å°çº¢ä¹¦"
  python3 xhs_quad_brain.py "åˆ†æè¿™ä¸ªå¯¹æ ‡è´¦å·çš„å†…å®¹ç­–ç•¥" --max-retries 3
  python3 xhs_quad_brain.py "åˆ›ä½œèŒåœºåæ§½å†…å®¹" -v
        """
    )
    
    parser.add_argument('task', help='ä»»åŠ¡æè¿°ï¼Œä¾‹å¦‚ï¼šå†™ä¸€ç¯‡å…³äºæ—©å…«å¦†çš„å°çº¢ä¹¦')
    parser.add_argument('--max-retries', '-r', type=int, default=2,
                       help='æœ€å¤§è¿­ä»£æ¬¡æ•°ï¼ˆé»˜è®¤: 2ï¼‰')
    parser.add_argument('--verbose', '-v', action='store_true',
                       help='æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯')
    
    args = parser.parse_args()
    
    result = run_xhs_quad_brain(args.task, args.max_retries, args.verbose)
    
    # è¾“å‡ºäººæ ¼æç¤ºè¯ï¼ˆæ–¹ä¾¿å¤åˆ¶ä½¿ç”¨ï¼‰
    if args.verbose:
        print("\nğŸ“‹ äººæ ¼æç¤ºè¯ï¼ˆç”¨äº sessions_spawnï¼‰:")
        print("=" * 50)
        for role, persona in PERSONAS.items():
            print(f"\n{ROLE_NAMES[role]}:")
            print(f"{persona[:300]}...")


if __name__ == "__main__":
    main()
