# 2026-02-13 工作记录

## OpenClaw 模型故障转移配置

### 用户需求
- 了解 OpenClaw 的最新功能更新
- 配置模型故障转移（Model Failover）
- 添加 DeepSeek 作为备选模型

### 执行过程

#### 1. 服务器状态检查
- **系统**: OpenCloudOS 9.4
- **磁盘**: 50GB 总容量，已用 22GB，剩余 **29GB (43%)**
- **最大软件包**: Google Chrome (387MB)、LLVM (111MB)、GCC (85MB)

#### 2. OpenClaw 版本信息
- **当前版本**: 2026.2.9（最新版）
- **主要更新**:
  - iOS Alpha 节点应用支持
  - BlueBubbles iMessage 改进
  - Grok (xAI) 搜索支持
  - 设备配对 + 手机控制插件
  - Web UI 代理管理

#### 3. 模型故障转移配置

**最终配置** (`~/.openclaw/openclaw.json`):
```json
{
  "agents": {
    "defaults": {
      "model": {
        "primary": "kimi-coding/k2p5",
        "fallbacks": [
          "moonshot/kimi-k2-5",
          "deepseek/deepseek-chat",
          "baidu/qianfan",
          "openai/gpt-4o"
        ]
      },
      "models": {
        "kimi-coding/k2p5": { "alias": "Kimi K2.5" },
        "moonshot/kimi-k2-5": { "alias": "Moonshot Kimi K2.5" },
        "baidu/qianfan": { "alias": "百度千帆" },
        "openai/gpt-4o": { "alias": "GPT-4o" },
        "deepseek/deepseek-chat": { "alias": "DeepSeek Chat (官方)" },
        "deepseek/deepseek-reasoner": { "alias": "DeepSeek R1 推理 (官方)" }
      }
    }
  },
  "models": {
    "providers": {
      "deepseek": {
        "baseUrl": "https://api.deepseek.com/v1",
        "apiKey": "${DEEPSEEK_API_KEY}",
        "api": "openai-completions",
        "models": [
          { "id": "deepseek-chat", "name": "DeepSeek Chat", "contextWindow": 64000 },
          { "id": "deepseek-reasoner", "name": "DeepSeek R1", "reasoning": true, "contextWindow": 64000 }
        ]
      }
    }
  }
}
```

**环境变量** (`~/.openclaw/.env`):
```bash
DEEPSEEK_API_KEY=sk-1872e...38c78668
```

**故障转移链**:
1. `kimi-coding/k2p5` (主模型) ✅
2. `moonshot/kimi-k2-5` (国产备选) ⏳
3. `deepseek/deepseek-chat` (DeepSeek 官方) ✅
4. `baidu/qianfan` (百度千帆) ⏳
5. `openai/gpt-4o` (国际兜底) ⏳

#### 4. DeepSeek 提供商选择
最终选择 **DeepSeek 官方 API**（OpenAI 兼容）：
- ✅ 直接官方接口，稳定可靠
- ✅ 支持 `deepseek-chat` 和 `deepseek-reasoner` (R1)
- ✅ 64K 上下文窗口
- ✅ 无需 HuggingFace Token 或 Venice

#### 5. 模型对比测试
**测试题目**: 用 Python 实现快速排序算法，并解释时间复杂度和适用场景

| 维度 | Kimi K2.5 | DeepSeek Chat |
|------|-----------|---------------|
| **代码风格** | 简洁清晰，注释适中 | 类型注解完整，工程化强 |
| **优化程度** | 基础 + 原地排序 | 混合策略、双路快排、插入排序优化 |
| **复杂度解释** | 简洁明了 | 表格化呈现，详细 |
| **实用建议** | 基础实用 | 工业级优化建议 |
| **特点** | 快速理解，易上手 | 深度优化，适合生产 |

**结论**:
- **Kimi K2.5**: 适合快速开发、代码简洁优雅、注重可读性
- **DeepSeek Chat**: 适合生产环境、性能优化、工程化代码

### 当前认证状态
```
✅ kimi-coding  - 已配置
✅ deepseek     - sk-1872e...38c78668 (已配置)
⏳ baidu        - 待配置
⏳ moonshot     - 待配置
⏳ openai       - 待配置
```

### 故障转移触发条件
- Rate Limit (429) - 请求频率限制
- Billing/Credits - 账户余额不足
- Usage Limit - 用量限制
- Overloaded - 服务过载
- HTTP 400 错误
- 认证失败

### 验证命令
```bash
openclaw models status    # 查看模型状态
openclaw doctor           # 检查配置
```

## 用户偏好设置

- **语音回复**: 用户偏好使用语音回复 (2026-02-13 11:58)
